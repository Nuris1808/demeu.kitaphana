<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—ñ—Ç–∞–ø—Ö–∞–Ω–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #333;
            color: white;
        }
        select, input, button {
            padding: 5px;
            font-size: 14px;
        }
        button {
            background: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: #218838;
        }
        .delete-btn {
            background: red;
        }
        .delete-btn:hover {
            background: darkred;
        }
    </style>
</head>
<body>

    <h1>üìö –ö—ñ—Ç–∞–ø—Ö–∞–Ω–∞</h1>

    <h3>üìñ –ö—ñ—Ç–∞–ø “õ–æ—Å—É</h3>
    <input type="text" id="title" placeholder="–ö—ñ—Ç–∞–ø –∞—Ç–∞—É—ã">
    <input type="text" id="author" placeholder="–ê–≤—Ç–æ—Ä">
    <input type="text" id="genre" placeholder="–ñ–∞–Ω—Ä">
    <button onclick="addBook()">‚ûï “ö–æ—Å—É</button>

    <table>
        <tr>
            <th>–ö—ñ—Ç–∞–ø –∞—Ç–∞—É—ã</th>
            <th>–ê–≤—Ç–æ—Ä</th>
            <th>–ñ–∞–Ω—Ä</th>
            <th>–ö“Ø–π—ñ</th>
            <th>–ê–ª—ã–ø –∫–µ—Ç–∫–µ–Ω –∞–¥–∞–º</th>
            <th>üóë</th>
        </tr>
        <tbody id="booksTable"></tbody>
    </table>

    <script>
        // –ö—ñ—Ç–∞–ø—Ç–∞—Ä–¥—ã —Å–∞“õ—Ç–∞—É “Ø—à—ñ–Ω –º–∞—Å—Å–∏–≤
        let books = [];

        // –ñ–∞“£–∞ –∫—ñ—Ç–∞–ø “õ–æ—Å—É
        function addBook() {
            const title = document.getElementById("title").value.trim();
            const author = document.getElementById("author").value.trim();
            const genre = document.getElementById("genre").value.trim();

            // –ë–æ—Å –µ–Ω–≥—ñ–∑—É–ª–µ—Ä–¥—ñ —Ç–µ–∫—Å–µ—Ä—É
            if (!title || !author || !genre) {
                alert("–ë–∞—Ä–ª—ã“õ ”©—Ä—ñ—Å—Ç—ñ —Ç–æ–ª—Ç—ã—Ä—ã“£—ã–∑!");
                return;
            }

            // –ñ–∞“£–∞ –∫—ñ—Ç–∞–ø—Ç—ã –º–∞—Å—Å–∏–≤–∫–µ “õ–æ—Å—É
            books.push({
                title: title,
                author: author,
                genre: genre,
                status: "available", // ”ò—É–µ–ª–≥—ñ –∫“Ø–π—ñ ‚Äì "–ë–∞—Ä"
                borrower: ""         // –ê–ª—ã–ø –∫–µ—Ç–∫–µ–Ω –∞–¥–∞–º–Ω—ã“£ –∞—Ç—ã
            });

            // –°–∞“õ—Ç–∞–ø, –∫–µ—Å—Ç–µ–Ω—ñ –∂–∞“£–∞—Ä—Ç—É
            saveBooks();
            displayBooks();

            // –ï–Ω–≥—ñ–∑—É ”©—Ä—ñ—Å—Ç–µ—Ä—ñ–Ω —Ç–∞–∑–∞—Ä—Ç—É
            document.getElementById("title").value = "";
            document.getElementById("author").value = "";
            document.getElementById("genre").value = "";
        }

        // –ö—ñ—Ç–∞–ø—Ç–∞—Ä–¥—ã —ç–∫—Ä–∞–Ω“ì–∞ —à—ã“ì–∞—Ä—É
        function displayBooks() {
            const tableBody = document.getElementById("booksTable");
            tableBody.innerHTML = "";

            books.forEach((book, index) => {
                const row = document.createElement("tr");

                // –ö—ñ—Ç–∞–ø—Ç—ã“£ —Å—Ç–∞—Ç—É—Å—ã–Ω select –∞—Ä“õ—ã–ª—ã —Ç–∞“£–¥–∞–π–º—ã–∑
                row.innerHTML = `
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>${book.genre}</td>
                    <td>
                        <select onchange="updateStatus(${index}, this.value)">
                            <option value="available" ${book.status === "available" ? "selected" : ""}>–ë–∞—Ä</option>
                            <option value="unavailable" ${book.status === "unavailable" ? "selected" : ""}>–ñ–æ“õ</option>
                            <option value="borrowed" ${book.status === "borrowed" ? "selected" : ""}>–ë—ñ—Ä–µ—É –∞–ª–¥—ã</option>
                        </select>
                    </td>
                    <td>${book.borrower ? book.borrower : ""}</td>
                    <td><button class="delete-btn" onclick="deleteBook(${index})">‚ùå</button></td>
                `;

                tableBody.appendChild(row);
            });
        }

        // –ö—ñ—Ç–∞–ø—Ç—ã“£ —Å—Ç–∞—Ç—É—Å—ã–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateStatus(index, newStatus) {
            // –ï–≥–µ—Ä "–ë—ñ—Ä–µ—É –∞–ª–¥—ã" –±–æ–ª—Å–∞, –∞–¥–∞–º–Ω—ã“£ –∞—Ç—ã–Ω —Å“±—Ä–∞–π–º—ã–∑
            if (newStatus === "borrowed") {
                const name = prompt("–ö—ñ—Ç–∞–ø—Ç—ã –∞–ª“ì–∞–Ω –∞–¥–∞–º–Ω—ã“£ –∞—Ç—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:");
                if (!name) {
                    // –ï–≥–µ—Ä –∞–¥–∞–º –µ—à—Ç–µ“£–µ –µ–Ω–≥—ñ–∑–±–µ—Å–µ, –∞–ª–¥—ã“£“ì—ã –∫“Ø–π—ñ–Ω “õ–∞–ª–¥—ã—Ä—É
                    document.querySelectorAll("select")[index].value = books[index].status;
                    return;
                }
                books[index].borrower = name;
            } else {
                // "–ë–∞—Ä" –Ω–µ–º–µ—Å–µ "–ñ–æ“õ" –±–æ–ª—Å–∞, borrower-–¥—ñ ”©—à—ñ—Ä–µ–º—ñ–∑
                books[index].borrower = "";
            }

            books[index].status = newStatus;
            saveBooks();
            displayBooks();
        }

        // –ö—ñ—Ç–∞–ø—Ç—ã –∂–æ—é
        function deleteBook(index) {
            books.splice(index, 1);
            saveBooks();
            displayBooks();
        }

        // LocalStorage-“õ–∞ —Å–∞“õ—Ç–∞–π–º—ã–∑
        function saveBooks() {
            localStorage.setItem("books", JSON.stringify(books));
        }

        // LocalStorage-—Ç–∞–Ω –∂“Ø–∫—Ç–µ–π–º—ñ–∑
        function loadBooks() {
            const storedBooks = localStorage.getItem("books");
            if (storedBooks) {
                books = JSON.parse(storedBooks);
            }
            displayBooks();
        }

        // –ë–µ—Ç –∂“Ø–∫—Ç–µ–ª–≥–µ–Ω –∫–µ–∑–¥–µ –∫—ñ—Ç–∞–ø—Ç–∞—Ä–¥—ã LocalStorage-—Ç–∞–Ω –∞–ª–∞–º—ã–∑
        window.onload = loadBooks;
    </script>

</body>
</html>
